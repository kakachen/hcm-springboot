<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
				xmlns:h="http://xmlns.jcp.org/jsf/html"
				xmlns:lc="http://java.sun.com/jsf/composite/components">

	<script type="text/javascript">
		google.charts.load('current', {'packages':['corechart']});
		google.charts.setOnLoadCallback(drawCharts);

		function drawCharts() {
			drawChart('Presenças por mês', '#{chartsController.presencesPerMonthModel}', 'presencesPerMonthChart', google.visualization.ColumnChart, { colors: ['#3949ab'] });
			drawChart('Sessões por câmara', '#{chartsController.sessionsPerChamberModel}', 'sessionsPerChamberChart', google.visualization.BarChart, { colors: ['#2f353e'], hAxis: { minValue: 0 }});
			drawChart('Sessões por convênio', '#{chartsController.sessionsPerHealthInsuranceModel}', 'sessionsPerHealthInsuranceChart', google.visualization.PieChart, { legend: { position: 'right' }});
			drawChart('Sessões por mês', '#{chartsController.monthlySessionsModel}', 'monthlySessionsChart', google.visualization.LineChart);
			drawChart('Pacientes por indicação médica', '#{chartsController.patientsPerMedicalIndicationModel}', 'patientsPerMedicalIndicationChart', google.visualization.PieChart, { sliceVisibilityThreshold: 0.0, pieHole: 0.4, colors: ['#e53935', '#3949ab', '#43a047'], legend: { position: 'right' } });
			drawChart('Pacientes por motivos consulta', '#{chartsController.patientsPerConsultationReasonModel}', 'patientsPerConsultationReasonChart', google.visualization.ColumnChart, { colors: ['#00897b'] });
		}

		function drawChart(title, dataArray, elementId, chartType, additionalOptions) {
			if (!dataArray) return;

			var options = {
				title: title,
				legend: { position: 'none' },
				sliceVisibilityThreshold: 0.04,
				pieResidueSliceColor: '#2f353e',
				pieResidueSliceLabel: "Outros",
				animation:{
					startup: true,
					duration: 1000,
					easing: 'out'
				},
				colors: [ '#d81b60', '#3949ab', '#00897b', '#e53935', '#546e7a', '#5e35b1', '#f06292', '#7986cb', '#4db6ac', '#e57373', '#e0e0e0', '#9575cd' ]
			};

			options = $.extend({}, options, additionalOptions);

			var data = google.visualization.arrayToDataTable(JSON.parse(dataArray));
			var chart = new chartType(document.getElementById(elementId));
			chart.draw(data, options);
		}
	</script>

	<h:form>
		<lc:headerPanel title="#{msg['title.statistics']}" />

		<div class="content-wrapper">
			<div class="ui-g">
				<div class="ui-g-4">
					<div id="presencesPerMonthChart" class="chart"></div>
				</div>
				<div class="ui-g-4">
					<div id="patientsPerConsultationReasonChart" class="chart"></div>
				</div>
				<div class="ui-g-4">
					<div id="patientsPerMedicalIndicationChart" class="chart"></div>
				</div>
			</div>
			<div class="ui-g">
				<div class="ui-g-4">
					<div id="sessionsPerHealthInsuranceChart" class="chart"></div>
				</div>
				<div class="ui-g-4">
					<div id="monthlySessionsChart" class="chart"></div>
				</div>
				<div class="ui-g-4">
					<div id="sessionsPerChamberChart" class="chart"></div>
				</div>
			</div>
		</div>
	</h:form>
	<script type="text/javascript">
		track('Charts page');
	</script>
</ui:composition>