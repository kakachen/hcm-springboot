<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

<f:view contentType="text/html" encoding="UTF-8">
	<h:head>
		<ui:include src="/layout/headCommons.xhtml" />
	</h:head>
	
	<h:body styleClass="login-page">
		<div class="container">
			<h:form id="login" prependId="false">
				<pe:tooltip for="logo" value="" />
				<div class="container">
					<div class="row login-logo">
						<div class="col-xs-2">
							<p:graphicImage id="logo" value="/resources/images/logo-white.png" styleClass="animate-0 zoomIn" />
						</div>
						<div class="col-xs-10">
							<div class="login-title">#{msg['title.appTitle']}</div>
							<div class="version animate-2 fadeIn" style="#{loginController.newVersion ? 'color: #57f547' : ''}">#{version['version']}</div>
						</div>
					</div>

					<ui:param name="isDev" value="#{facesContext.application.projectStage eq 'Development'}" />
					<div class="row login-inner-panel">
						<div class="login-error-message">
							<p:messages />
						</div>
						<div class="row">
							<div class="login-input col-md-12">
								<p:inputText id="username" value="#{loginController.username}" required="#{not isDev}" requiredMessage="#{msg['error.loginRequired']}" label="#{msg['label.username']}" size="50" />
								<p:watermark for="login:username" value="#{msg['label.login']}" />
								<div class="input-icon"><span class="fa fa-at" /></div>
							</div>
						</div>
						<div class="row">
							<div class="login-input col-md-12">
								<p:password id="password" value="#{loginController.password}" required="#{not isDev}" requiredMessage="#{msg['error.passwordRequired']}" label="#{msg['label.password']}" size="50" />
								<p:watermark for="login:password" value="#{msg['label.password']}" />
								<div class="input-icon"><span class="fa fa-lock" /></div>
							</div>
						</div>
						<div class="row">
							<div class="login-input col-xs-#{isDev ? '4' : '12' }">
								<p:commandButton id="loginButton" value="#{msg['button.login']}" process="@form" action="#{loginController.login}" ajax="false" onclick="mixpanel.track('Sign-in', { username: $('#username').val()});" style="width: 100%;" />
							</div>
							<div class="login-input login-button col-xs-2">
								<p:commandButton icon="fa fa-user fa-lg" value="USER" process="@form" action="#{loginController.login}" ajax="false" rendered="#{isDev}">
									<f:setPropertyActionListener value="user" target="#{loginController.username}" />
									<f:setPropertyActionListener value="123" target="#{loginController.password}" />
								</p:commandButton>
							</div>
								<div class="login-input login-button col-xs-2">
								<p:commandButton icon="fa fa-cog fa-lg" value="ADMIN" process="@form" action="#{loginController.login}" ajax="false" rendered="#{isDev}">
									<f:setPropertyActionListener value="admin" target="#{loginController.username}" />
									<f:setPropertyActionListener value="123" target="#{loginController.password}" />
								</p:commandButton>
								</div>
									<div class="login-input login-button col-xs-2">
								<p:commandButton icon="fa fa-wrench fa-lg" value="DEV" process="@form" action="#{loginController.login}" ajax="false" rendered="#{isDev}">
									<f:setPropertyActionListener value="thiago" target="#{loginController.username}" />
									<f:setPropertyActionListener value="admin" target="#{loginController.password}" />
								</p:commandButton>
							</div>
						</div>
					</div>
				</div>
        	</h:form>

        	<h:form>
				<p:remoteCommand name="setClientTimeZone" actionListener="#{loginController.setClientTimeZone()}" />
			</h:form>
		</div>
		<script type="text/javascript">
			$().ready(function() {
				mixpanel.track('Login page');

				var timeZone = new Date().getTimezoneOffset() / 60 * -1;
				setClientTimeZone([{ name: 'clientTimeZone', value: timeZone }]);
			});
		</script>
	</h:body>
</f:view>
</html>